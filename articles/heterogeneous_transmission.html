<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Heterogeneous Transmission • ramp.xds</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Heterogeneous Transmission">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">ramp.xds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.98</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/adult_RM.html">A Ross-Macdonald Adult Mosquito Model</a></li>
    <li><a class="dropdown-item" href="../articles/AdultMosquitoes.html">Adult Mosquito Models</a></li>
    <li><a class="dropdown-item" href="../articles/aqua_basic.html">basicL_xde Competition Aquatic Mosquito Model</a></li>
    <li><a class="dropdown-item" href="../articles/aqua_trace.html">Trace (exogenously forced) Aquatic Mosquito Model</a></li>
    <li><a class="dropdown-item" href="../articles/BedNets.html">Bed Nets</a></li>
    <li><a class="dropdown-item" href="../articles/Contributing.html">Contributing</a></li>
    <li><a class="dropdown-item" href="../articles/ex_534.html">5-3-4 Example</a></li>
    <li><a class="dropdown-item" href="../articles/Forcing.html">Exogenous Forcing</a></li>
    <li><a class="dropdown-item" href="../articles/GettingStarted.html">Getting Started with `ramp.xds`</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_biting.html">Heterogeneous Biting</a></li>
    <li><a class="dropdown-item" href="../articles/heterogeneous_transmission.html">Heterogeneous Transmission</a></li>
    <li><a class="dropdown-item" href="../articles/History.html">RAMP Software: A History</a></li>
    <li><a class="dropdown-item" href="../articles/human_hmoi.html">Hybrid MoI (Multiplicity of Infection) Human Model</a></li>
    <li><a class="dropdown-item" href="../articles/human_seis.html">SEIS and SEISd</a></li>
    <li><a class="dropdown-item" href="../articles/human_sip.html">SIP_xde (Susceptible-Infected-Prophylaxis) Human Model</a></li>
    <li><a class="dropdown-item" href="../articles/human_sis.html">SIS-xde (Susceptible-Infected-Susceptible) Human Model</a></li>
    <li><a class="dropdown-item" href="../articles/modular_forms.html">Modular Forms for Disease Dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/modularity.html">Nimble Model Building</a></li>
    <li><a class="dropdown-item" href="../articles/Nimble.html">Nimble Model Building and Scalable Complexity</a></li>
    <li><a class="dropdown-item" href="../articles/RM-dts-Mosquito.html">Basic Mosquito Infection Dynamics in Discrete Time</a></li>
    <li><a class="dropdown-item" href="../articles/spat_metric.html">Spatial Metrics</a></li>
    <li><a class="dropdown-item" href="../articles/TraceFunctions.html">Trace Functions</a></li>
    <li><a class="dropdown-item" href="../articles/Understanding_ramp.xds.html">Understanding ramp.xds</a></li>
    <li><a class="dropdown-item" href="../articles/vc_lemenach.html">ITN-based Vector Control</a></li>
    <li><a class="dropdown-item" href="../articles/VectorControl.html">Vector Control</a></li>
    <li><a class="dropdown-item" href="../articles/Working.html">Working with Models in `ramp.xds`</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/dd-harp/ramp.xds/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Heterogeneous Transmission</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.xds/blob/main/vignettes/heterogeneous_transmission.Rmd" class="external-link"><code>vignettes/heterogeneous_transmission.Rmd</code></a></small>
      <div class="d-none name"><code>heterogeneous_transmission.Rmd</code></div>
    </div>

    
    
<p>Heterogeneous transmission includes several closely related
concepts:</p>
<ul>
<li><p><strong><a href="heterogeneous_biting.html">Heterogeneous
Biting</a></strong> describes differences among population strata in the
average rate of exposure. In effect, heterogeneous biting is a kind of
<em>frailty.</em> In <strong><code>ramp.xds</code>,</strong>
heterogeneous biting is implemented through <em>blood feeding search
weights.</em></p></li>
<li><p><strong><a href="environmental_heterogeneity.html">Environmental
Heterogeneity</a></strong> describes the distribution of the expected
number of bites in otherwise homogeneous populations strata; if the
expected number of bites is <em>Gamma</em> distributed, then the number
of bites, per person, would have a negative binomial distribution.
Environmental heterogeneity is implemented in <code>Exposure</code>
through a function <code>F_foi</code> or <code>F_ar</code> that converts
the daily entomological inoculation rate into a daily force of infection
under some probabilistic model for the distribution of the
expectation.</p></li>
<li><p><strong><a href="heterogeneous_mixing.html">Heterogeneous
Mixing</a></strong> describes departures in a model from the idealized
<em>mass-action</em> assumption for two-species mixing. The algorithms
in <code>ramp.xds</code> compute the mixing matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>
integrates information about time spent, mosquito daily activity
patterns, the sizes of various population strata, search weights, other
vertebrate hosts, and visitors.</p></li>
<li><p>Temporal variability in mosquito populations driven by exogenous
factors, such as weather and vector control, that modify <em>potential
transmission</em> by mosquito populations, including
<strong>seasonality</strong> and long-term trends.</p></li>
</ul>
<div class="section level2">
<h2 id="blood-feeding">Blood Feeding<a class="anchor" aria-label="anchor" href="#blood-feeding"></a>
</h2>
<p>Blood feeding by mosquitoes plays a core role in transmission. In
simple models, the blood feeding parameters are often treated as being a
result of some innate biological constraints on mosquito species. In
<strong><code>ramp.xds</code>,</strong> blood feeding is motivated by
<em>searching for resources</em> and handled by a rigid but configurable
interface that guarantees mathematical consistency.<br>
Blood feeding is thus an interaction among humans and mosquitoes. This
interface computes:</p>
<ul>
<li><p>The overall blood feeding rate, (<em>e.g.</em> the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>f</mi><annotation encoding="application/x-tex">f</annotation></semantics></math>);</p></li>
<li><p>The human fraction (<em>e.g.</em> the parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>q</mi><annotation encoding="application/x-tex">q</annotation></semantics></math>);</p></li>
<li><p>The availability of humans / hosts or other vertebrates for
mosquitoes searching for blood;</p></li>
<li><p>The mixing matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>;</p></li>
</ul>
<p>Parasite transmission is spatially heterogeneous because mosquito
populations have preferences for resources whose availability is
spatially heterogeneous. Available resources can be modified, in part,
because human behaviors are heterogeneous. Heterogeneous blood feeding
and transmission is an important aspect of malaria transmission dynamics
and control, and it has been implemented in <code>ramp.xds</code>
through several related concepts and constructs.</p>
<ul>
<li><p><em>Mosquito populations</em> are heterogeneous over space and
time. Spatial dynamics in <code>ramp.xds</code> are organized around the
concept of a <em>patch.</em> The adult mosquito populations in each
<em>state</em> are assumed to be homogeneously distributed within each
patch.</p></li>
<li><p><em>Human populations:</em> and human behaviors are heterogeneous
in ways that affect exposure and transmission. The design of
<code>ramp.xds</code> makes it possible to <em>sub-divide</em> the human
population into an arbitrary number of homogeneous strata.</p></li>
<li><p><em>Blood feeding</em> is an interaction between mosquitoes and
humans that gives rise to parasite transmission. The design of
<code>ramp.xds</code> has a new model for blood feeding that
incorporates various kinds of heterogeneous transmission.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="environmental-heterogeneity">Environmental Heterogeneity<a class="anchor" aria-label="anchor" href="#environmental-heterogeneity"></a>
</h2>
<p>In mechanistic models of malaria, the hazard rate for exposure is
generally assumed to be a linear function of the entomological
inoculation rate. In the following, we assume that the number of bites
per person over a day (or over some longer interval,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>τ</mi><annotation encoding="application/x-tex">\tau</annotation></semantics></math>),
is a random variable, and we formulate approximating models for attack
rates and hazard rates.</p>
<div class="section level4">
<h4 id="poisson-hazard-rates">Poisson Hazard Rates<a class="anchor" aria-label="anchor" href="#poisson-hazard-rates"></a>
</h4>
<p>We let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
denote the EIR, the expected number of bites per person over a day. If
we assume that the distribution of the daily EIR is Poisson, and if a
fraction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>
of infective bites cause an infection, then the relationship between the
between EIR and the FoI is a Poisson compounded with a binomial, which
is also Poisson:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∼</mo><msub><mi>F</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>,</mo><mtext mathvariant="normal">mu</mtext><mo>=</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Z \sim F_E(z) = \mbox{Poisson}(z, \mbox{mu} = bE(t))
</annotation></semantics></math></p>
<p>Over a day, the daily attack rate,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>,
is the fraction of individuals who received at least one infection,
or:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>α</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mtext mathvariant="normal">Poisson</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mtext mathvariant="normal">mu</mtext><mo>=</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></msup></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rl}
\alpha &amp;= 1-F_E(0) \\ &amp;= 1-\mbox{Poisson}(0, \mbox{mu} = bE(t)) \\ 
&amp;= 1- e^{-bE(t)} \\
\end{array}
</annotation></semantics></math></p>
<p>The daily FoI,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>h</mi><annotation encoding="application/x-tex">h</annotation></semantics></math>,
is given by a generic formula:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>e</mi><mrow><mo>−</mo><mi>h</mi></mrow></msup><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or equivalently </mtext><mspace width="0.333em"></mspace></mrow><mi>h</mi><mo>=</mo><mo>−</mo><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\alpha = 1 - e^{-h} \mbox{ or equivalently } h = -\ln (1-\alpha)
</annotation></semantics></math></p>
<p>In this case, the relationship between the FoI and the EIR is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
   h(t) = b E(t)
</annotation></semantics></math></p>
<p>It is highly mathematically convenient that the relationship is
invariant with respect to the sampling period.</p>
</div>
<div class="section level4">
<h4 id="negative-binomial-daily-hazards">Negative Binomial Daily Hazards<a class="anchor" aria-label="anchor" href="#negative-binomial-daily-hazards"></a>
</h4>
<p>If we assume the number of infective bites, per person, per day, has
a Gamma distribution in a population, then we could model the number of
infective bites as a Gamma - Poisson mixture process, or a negative
binomial distribution. Under this model, the counts for bites by
sporozoite positive mosquitoes over one day,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Z</mi><annotation encoding="application/x-tex">Z</annotation></semantics></math>,
would be a negative binomial random variable with mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Z</mi><mo>∼</mo><msub><mi>F</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mi>z</mi><mo>,</mo><mtext mathvariant="normal">mu</mtext><mo>=</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mtext mathvariant="normal">size</mtext><mo>=</mo><mn>1</mn><mi>/</mi><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
Z \sim F_E(z) = \mbox{NB}(z, \mbox{mu} = bE(t), \mbox{size} = 1/\phi)
</annotation></semantics></math></p>
<p>Assuming an infectious bite causes an infection with probability
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>b</mi><annotation encoding="application/x-tex">b</annotation></semantics></math>,
the daily attack rate is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mtable><mtr><mtd columnalign="right" style="text-align: right"><mi>α</mi></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><msub><mi>F</mi><mi>E</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><mtext mathvariant="normal">NB</mtext><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mtext mathvariant="normal">mu</mtext><mo>=</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mtext mathvariant="normal">size</mtext><mo>=</mo><mn>1</mn><mi>/</mi><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mtd></mtr><mtr><mtd columnalign="right" style="text-align: right"></mtd><mtd columnalign="left" style="text-align: left"><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo>−</mo><mn>1</mn><mi>/</mi><mi>ϕ</mi></mrow></msup></mtd></mtr></mtable><annotation encoding="application/x-tex">
\begin{array}{rl}
\alpha &amp;= 1-F_E(0) \\ &amp;= 1-\mbox{NB}(0, \mbox{mu} = b E(t), \mbox{size} = 1/\phi) \\
 &amp;= 1- \left(1+b E(t)\phi \right)^{-1/\phi}
\end{array}
</annotation></semantics></math></p>
<p>This is consistent with a formula that has a continuous daily
FoI:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>h</mi><mo>=</mo><mfrac><mrow><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>+</mo><mi>b</mi><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>ϕ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mi>ϕ</mi></mfrac></mrow><annotation encoding="application/x-tex">
    h = \frac{\ln \left(1 + bE(t)\phi \right)} {\phi}
</annotation></semantics></math></p>
</div>
</div>
<div class="section level2">
<h2 id="heterogeneous-biting">Heterogeneous Biting<a class="anchor" aria-label="anchor" href="#heterogeneous-biting"></a>
</h2>
<p><strong>Heterogeneous Biting</strong> is defined throughout the
<code>ramp.xds</code> implementation and documentation as a difference
in the relative biting rates for two strata that are otherwise
identical. The implementation relies on two concepts:</p>
<ul>
<li><p><strong>blood feeding search weights</strong> or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mi>ω</mi><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{\omega\right\}</annotation></semantics></math>
describe multiplicative differences among population strata in their
availability to blood feeding mosquitoes</p></li>
<li><p><strong>relative biting rates</strong> or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mi>ξ</mi><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{\xi\right\}</annotation></semantics></math></p></li>
</ul>
<p>To be more rigorous, let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>E</mi><annotation encoding="application/x-tex">E</annotation></semantics></math>
denote the <em>average</em> daily entomological inoculation rate (dEIR)
for a population with multiple strata, and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ξ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\xi_i</annotation></semantics></math>
the frailty term, then the dEIR for the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
stratum is:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>E</mi><mi>i</mi></msub><mo>=</mo><msub><mi>ξ</mi><mi>i</mi></msub><mi>E</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">E_i = \xi_i E.</annotation></semantics></math></p>
<p>The implementation is part of a coherent model for blood feeding that
serves at the interface between models of parasite/pathogen infections
in humans (<em>i.e.</em> <span class="math inline">$\cal X$</span>), and
models of parasite infections in mosquitoes (<em>i.e.</em> <span class="math inline">$\cal YZ$</span>). In this vignette, we introduce
the <em>concept</em> of heterogeneous biting and its implementation in
the blood feeding model using <strong>blood feeding search
weights.</strong></p>
<div class="section level3">
<h3 id="blood-feeding-search-weights">Blood Feeding Search Weights<a class="anchor" aria-label="anchor" href="#blood-feeding-search-weights"></a>
</h3>
<p>A flexible implementation is handled through the blood feeding model,
which includes the the concepts of <em>blood feeding search weights</em>
and <em>availability</em>. The search weights,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="true" form="prefix">{</mo><mi>ω</mi><mo stretchy="true" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\left\{\omega\right\}</annotation></semantics></math>,
are a measure of how easy it is for mosquitoes to find and blood feed on
a host.</p>
<p>We let
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mi>i</mi></msub><annotation encoding="application/x-tex">H_i</annotation></semantics></math>
denote the size of the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>i</mi><mrow><mi>t</mi><mi>h</mi></mrow></msup><annotation encoding="application/x-tex">i^{th}</annotation></semantics></math>
population, where
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>H</mi><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>H</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">H = \sum_i H_i.</annotation></semantics></math>
The total <em>availability</em> of humans for blood feeding is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi><mo>=</mo><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>ω</mi><mi>i</mi></msub><msub><mi>H</mi><mi>i</mi></msub><mi>.</mi></mrow><annotation encoding="application/x-tex">W = \sum_i \omega_i H_i.</annotation></semantics></math>
Availability is used to compute the overall blood feeding rate for
mosquitoes and the human fraction (human blood meals as a fraction of
all blood meals). If we assign a biting weight to a stratum, then the
fraction of bites received by that stratum is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><msub><mi>ω</mi><mi>i</mi></msub><msub><mi>H</mi><mi>i</mi></msub></mrow><mi>W</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex"> \frac{\omega_i H_i}W.</annotation></semantics></math><strong>Example 1:</strong> For example, suppose that there are 200
people with a biting weight of 2.25 and 800 people with a biting weight
of 1. In this model, the first stratum would get 36% of the total
bites:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">2.25</span><span class="op">*</span><span class="fl">200</span><span class="op">/</span><span class="op">(</span><span class="fl">2.25</span><span class="op">*</span><span class="op">(</span><span class="fl">200</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">*</span><span class="op">(</span><span class="fl">800</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.36</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="relative-biting-rates">Relative Biting Rates<a class="anchor" aria-label="anchor" href="#relative-biting-rates"></a>
</h3>
<p>The relative biting rates are defined at the top.</p>
<p>The relative biting rates are constrained such that
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><munder><mo>∑</mo><mi>i</mi></munder><msub><mi>ξ</mi><mi>i</mi></msub><mfrac><msub><mi>H</mi><mi>i</mi></msub><mi>H</mi></mfrac><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\sum_i \xi_i \frac{H_i}H = 1</annotation></semantics></math></p>
<p><strong>Example 2:</strong></p>
<p>For example, if 20% of the population gets bitten at a rate that is
80% higher than the population average, then the other 80% must get
bitten (on average) at a rate that is 80% of the population average.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fl">1.8</span><span class="op">*</span><span class="fl">0.2</span><span class="op">+</span> <span class="fl">0.8</span><span class="op">*</span><span class="fl">0.8</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
<p>Relative biting rates are computed automatically from the blood
feeding search weights,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">{</mo><mi>ω</mi><mo stretchy="true" form="postfix">}</mo></mrow><mo>,</mo></mrow><annotation encoding="application/x-tex">\left\{\omega\right\},</annotation></semantics></math>
where</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ξ</mi><mi>i</mi></msub><mo>=</mo><msub><mi>ω</mi><mi>i</mi></msub><mfrac><mi>H</mi><mi>W</mi></mfrac><mi>.</mi></mrow><annotation encoding="application/x-tex">\xi_i = \omega_i\frac{H}{W}.</annotation></semantics></math></p>
<p><strong>Example 3</strong> computes the search weights from the
biting weights</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">searchWts</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.25</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">Hi</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>, <span class="fl">800</span><span class="op">)</span></span>
<span><span class="va">H</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">Hi</span><span class="op">)</span> </span>
<span><span class="va">W</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">searchWts</span><span class="op">*</span><span class="va">Hi</span><span class="op">)</span></span>
<span><span class="va">xi</span> <span class="op">=</span> <span class="va">searchWts</span><span class="op">*</span><span class="va">H</span><span class="op">/</span><span class="va">W</span></span>
<span><span class="va">xi</span> </span>
<span><span class="co">#&gt; [1] 1.8 0.8</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">xi</span><span class="op">*</span><span class="va">Hi</span><span class="op">)</span><span class="op">/</span><span class="va">H</span></span>
<span><span class="co">#&gt; [1] 1</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="heterogeneous-mixing">Heterogeneous Mixing<a class="anchor" aria-label="anchor" href="#heterogeneous-mixing"></a>
</h2>
<p>Heterogeneous blood feeding is a basic feature of malaria
transmission (see <a href="heterogeneous_transmission.html">Heterogeneous Transmission</a>.
In <code>exDE,</code> the term <strong>heterogeneous biting</strong> is
used to describe departures from the ideal assumption of
<em>mass-action,</em> a topic explored by Perkins TA, <em>et al.</em>
(2013)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Perkins TA, Scott TW, Le Menach A, Smith DL (2013).
Heterogeneity, mixing, and the spatial scales of mosquito-borne pathogen
transmission. PLoS Comput Biol 9: e1003327, &lt;a href="https://doi.org/10.1371/journal.pcbi.1003540" class="external-link uri"&gt;https://doi.org/10.1371/journal.pcbi.1003540&lt;/a&gt;&lt;/p&gt;'><sup>1</sup></a>.
. Other departures from being <em>well-mixed</em> fall under the
category of <em>heterogeneous mixing.</em> Computation of the mixing
matrix,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>,
is described in detail by Wu SL, <em>et al.</em>, (2023)<a class="footnote-ref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Wu SL, Henry JM, Citron DT, &lt;em&gt;et al.&lt;/em&gt; (2023).
Spatial dynamics of malaria transmission. PLoS Comput Biol 19: e1010684,
&lt;a href="https://doi.org/10.1371/journal.pcbi.1010684" class="external-link uri"&gt;https://doi.org/10.1371/journal.pcbi.1010684&lt;/a&gt;&lt;/p&gt;'><sup>2</sup></a>.</p>
</div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
