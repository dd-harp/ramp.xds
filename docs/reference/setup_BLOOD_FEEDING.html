<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Set up a part of the xds object that defines the interface for blood feeding"><title>Set up Blood Feeding — setup_BLOOD_FEEDING • ramp.xds</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Set up Blood Feeding — setup_BLOOD_FEEDING"><meta property="og:description" content="Set up a part of the xds object that defines the interface for blood feeding"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ramp.xds</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99-2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/GettingStarted.html">Getting Started</a>
    <a class="dropdown-item" href="../articles/BasicSetup.html">Basic Setup</a>
    <a class="dropdown-item" href="../articles/modular_forms.html">Modular Forms</a>
    <a class="dropdown-item" href="../articles/Exposure.html">Exposure</a>
    <a class="dropdown-item" href="../articles/Contributing.html">Contributing</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-adult-mosquitoes">Adult Mosquitoes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-adult-mosquitoes">
    <a class="dropdown-item" href="../articles/adult_RM.html">Macdonald's Model</a>
    <a class="dropdown-item" href="../articles/RM-dts-Mosquito.html">Ross-Macdonald - discrete time</a>
    <a class="dropdown-item" href="../articles/adult_GeRM.html">Generalized Ross-Macdonald model</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-immature-mosquitoes">Immature Mosquitoes</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-immature-mosquitoes">
    <a class="dropdown-item" href="../articles/aqua_trace.html">Emergence (the trivial module)</a>
    <a class="dropdown-item" href="../articles/aqua_basic.html">basicL</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-human-host">Human / Host</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-human-host">
    <a class="dropdown-item" href="../articles/human_sis.html">SIS model</a>
    <a class="dropdown-item" href="../articles/human_hmoi.html">MoI hybrid model</a>
  </div>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Functions</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/dd-harp/ramp.xds/">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Set up Blood Feeding</h1>
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.xds/blob/HEAD/R/blood_feeding.R" class="external-link"><code>R/blood_feeding.R</code></a></small>
      <div class="d-none name"><code>setup_BLOOD_FEEDING.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Set up a part of the <strong><code>xds</code></strong> object that defines the interface for blood feeding</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">setup_BLOOD_FEEDING</span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>pars</dt>
<dd><p>an <strong><code>xds</code></strong> object</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a modified <strong><code>xds</code></strong> object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This implements a blood feeding model described by Wu SL, <em>et al.</em>, (2023).</p>
<p>Modular computation in ramp.xds requires a rigid interface to
guarantee mathematical consistency for blood feeding and transmission.
The interface is for blood feeding is defined by an object called <code>BFpar</code> that
is attached to the <strong><code>xds</code></strong> object pars as <code>pars$BFpar</code>. The blood feeding interface</p><ul><li><p>the residency matrix \(J\)</p></li>
<li><p>a time spent (TiSp) matrix \(\Theta\)</p></li>
<li><p>a circadian function <code>F_circadian</code> for each vector species</p></li>
<li><p>a time at risk (TaR) matrix \(\Psi\) that is the product the TiSp matrix and the circadian function</p></li>
<li><p>blood feeding search weights</p></li>
<li><p>a vector describing \(W\), the availability the population strata for blood feeding: the availability of the parasite/pathogen's hosts</p></li>
<li><p>a vector describing the availability of visitors</p></li>
<li><p>a vector describing the availability of other blood hosts</p></li>
<li><p>a vector describing \(B\), the total availability of all vertebrate blood hosts for blood feeding (see <code><a href="compute_B.html">compute_B()</a></code>)</p></li>
</ul><p>These quantities are used to model transmission (see <code><a href="setup_TRANSMISSION.html">setup_TRANSMISSION()</a></code>).</p>
<p>Mosquito bionomic parameters <em>ought</em> to be constrained. If bionomic parameters are
assigned, there's no guarantee they are internally mathematically consistent or sensible.
To guarantee internal consistency, the the concept of resource availability should be
used to compute the blood feeding rates (\(f\))
using <em>functional responses.</em> The human fraction ought to be \(q=W/B\).
Availability can also be used to model mosquito movement.</p>
<p><strong>Mulit-Host Models</strong> - In models with multiple host species, with availability \(W_i\), the fraction on
each host species would be \(W_i/B\).
In models with multiple vector species, each species could have different search habits and preferences,
so blood feeding availability is indexed for each species: \(B_s\) and \(W_{s}\).
In models with multiple host species, \(W_{i,s}\) is the availability of the
\(i^{th}\) host species to the \(s^{th}\) vector species.
For hosts, availability is based on <em>time spent</em> in each patch, and <em>time at risk,</em> or
time spent by time of day weighted by mosquito species-specific <em>search weights</em> reflecting different preferences
and a circadian function describing relative mosquito blood feeding rates by time of day.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wu SL, Henry JM, Citron DT, Ssebuliba DM, Nsumba JN, C HMS, Brady OJ, Guerra CA, García GA, Carter AR, Ferguson HM, Afolabi BE, Hay SI, Jr RCR, Kiware S, Smith DL (2023).
“Spatial dynamics of malaria transmission.”
<em>PLoS Computational Biology</em>, <b>19</b>(6), e1010684.
<a href="https://doi.org/10.1371/journal.pcbi.1010684" class="external-link">doi:10.1371/journal.pcbi.1010684</a>
, <a href="2023-06-27">2023-06-27</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="setup_TRANSMISSION.html">setup_TRANSMISSION</a></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer></div>

  

  

  </body></html>

