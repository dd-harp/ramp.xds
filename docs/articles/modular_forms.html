<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Modular Forms for Disease Dynamics • ramp.xds</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Modular Forms for Disease Dynamics">
<meta property="og:description" content="ramp.xds">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ramp.xds</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/GettingStarted.html">Getting Started with ramp.xds</a>
    </li>
    <li>
      <a href="../articles/Working.html">Working with Models in ramp.xds</a>
    </li>
    <li>
      <a href="../articles/Understanding_ramp.xds.html">Understanding ramp.xds</a>
    </li>
    <li>
      <a href="../articles/modularity.html">Modular Forms for Disease Dynamics</a>
    </li>
    <li>
      <a href="../articles/ex_534.html">5-3-4 Spatial Example</a>
    </li>
    <li>
      <a href="../articles/spat_metric.html">Spatial Metrics</a>
    </li>
    <li>
      <a href="../articles/vc_lemenach.html">Vector Control Example</a>
    </li>
    <li>
      <a href="../articles/Contributing.html">Contributing</a>
    </li>
    <li>
      <a href="../articles/heterogeneous_transmission.html">Heterogeneous Transmission</a>
    </li>
    <li>
      <a href="../articles/heterogeneous_biting.html">Heterogeneous Biting</a>
    </li>
    <li>
      <a href="../articles/heterogeneous_mixing.html">Heterogeneous Mixing</a>
    </li>
    <li>
      <a href="../articles/environmental_heterogeneity.html">Environmental Heterogeneity</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Adult
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/adult_RM.html">Ross-Macdonald model</a>
    </li>
    <li>
      <a href="../articles/RM-dts-Mosquito.html">Ross-Macdonald, discrete time</a>
    </li>
    <li>
      <a href="../articles/adult_GeRM.html">Generalized Ross-Macdonald model</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Mosquito - Aquatic
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/aqua_trivial.html">Aquatic - Trivial (forced) model</a>
    </li>
    <li>
      <a href="../articles/aqua_basic.html">Basic Competition</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Human / Host
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/human_sis.html">SIS model</a>
    </li>
    <li>
      <a href="../articles/human_sip.html">SIP xde model</a>
    </li>
    <li>
      <a href="../articles/human_hmoi.html">MoI hybrid model</a>
    </li>
    <li>
      <a href="../articles/human_seis.html">SEIS model</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/dd-harp/ramp.xds/" class="external-link">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Modular Forms for Disease Dynamics</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/dd-harp/ramp.xds/blob/HEAD/vignettes/modular_forms.Rmd" class="external-link"><code>vignettes/modular_forms.Rmd</code></a></small>
      <div class="hidden name"><code>modular_forms.Rmd</code></div>

    </div>

    
    
<p>A <strong>Modular Form</strong> for disease dynamics is a stylized
way of writing the dynamical systems that emphasizes the modular
structure of the process. A mathematical framework for building models
of malaria dynamics and control (and other mosquito-borne pathogens) was
described in <a href="https://journals.plos.org/ploscompbiol/article?id=10.1371/journal.pcbi.1010684" target="_blank" class="external-link">Spatial Dynamics of Malaria Transmission</a>, and the
framework was implemented in <code>ramp.xds.</code> The forms we
describe here rewrite models so that they closely resemble their
implementation in <code>ramp.xds</code>, which makes it possible to
relate written equations and computed code.</p>
<p>For an extended discussion of modularity, see the closely related
vignettes <a href="Understanding_ramp.xds.html" target="_blank">Understanding ramp.xds</a> and <a href="modularity.html">Generalized Modularity and Extensibility</a></p>
<div class="section level2">
<h2 id="a-standard-form">A Standard Form<a class="anchor" aria-label="anchor" href="#a-standard-form"></a>
</h2>
<p>There is no <em>standard form</em> for writing down systems of
differential equations: here, <em>a standard form</em> is any way of
writing down a system of equations that does not emphasize the
modularity, or <em>not a modular form.</em></p>
<p>To illustrate the modular form, we start with the
<em>Ross-Macdonald</em>-style model in Box 1.</p>
<hr>
<p><strong>Box 1: A Ross-Macdonald Model</strong></p>
<ul>
<li><p>Let the dependent variable <span class="math inline">\(I(t)\)</span> denote the density of infected
humans, and the parameter <span class="math inline">\(H\)</span> the
density of all humans</p></li>
<li><p>Let the dependent variable <span class="math inline">\(Y(t)\)</span> denote the density of infected
mosquitoes, and the parameter <span class="math inline">\(M\)</span> the
density of all mosquitoes</p></li>
<li><p>Let <span class="math inline">\(b\)</span> denote the fraction of
bites by infective mosquitoes that infect a human, and let <span class="math inline">\(r\)</span> denote the rate that infections
clear</p></li>
<li><p>Let <span class="math inline">\(c\)</span> denote the fraction of
blood meals on infectious humans infect a mosquito, and let <span class="math inline">\(g\)</span> denote the mosquito death rate</p></li>
<li><p>Let <span class="math inline">\(f\)</span> denote the overall
blood feeding rate, and <span class="math inline">\(q\)</span> the human
fraction</p></li>
<li><p>Let <span class="math inline">\(\tau\)</span> denote the
EIP.</p></li>
</ul>
<p>In this set of equations, we ignore the delay for sporogony, but we
count the mortality, so infections occur at the rate <span class="math inline">\(b e^{-g \tau} fqY/H.\)</span> We assume that the
daily FoI is linearly proportional to the daily EIR, consistent with a
Poisson model for exposure, so <span class="math inline">\(h =
bE.\)</span></p>
<p><span class="math display">\[ \begin{array}{rl}
dI/dt &amp;= b e^{-gn}fq \frac YH (H-I) - r I \\
dY/dt &amp;= fq c \frac IH (M-Y) - g Y
\end{array}\]</span></p>
<hr>
</div>
<div class="section level2">
<h2 id="in-modular-form">…in Modular Form<a class="anchor" aria-label="anchor" href="#in-modular-form"></a>
</h2>
<p>We illustrate by writing a Ross-Macdonald model in its modular form
(Figure 1). In the modular form, we identify the terms in one equation
that depend on the other variable. First, we focus on the equation
describing human infection dynamics. We note that it depends on a term
involving the variable <span class="math inline">\(Y.\)</span> The term
is epidemiologically meaningful – it is called the force of infection
(FoI). We let <span class="math inline">\(h\)</span> denote the FoI:
<span class="math display">\[h=b e^{-gn}fq \frac YH,\]</span></p>
<p>and now we can rewrite the equation</p>
<p><span class="math display">\[
dI/dt = h H (H-I) - r I
\]</span></p>
<p>Next, we isolate the equation describing mosquito infection dynamics,
we note that it depends on a term that we will call the net
infectiousness (NI).</p>
<p><span class="math display">\[\kappa = c \frac IH\]</span></p>
<p>The term <span class="math inline">\(c I\)</span> is the density of
infected humans, weighted by their infectiousness.</p>
<p>We note that <span class="math inline">\(fq\kappa\)</span> is the FoI
for mosquito infections, and now we can rewrite the equation for
mosquitoes:</p>
<p><span class="math display">\[
dY/dt = fq\kappa (M-Y) - g Y
\]</span></p>
<p>Since we also want to make this model extensible, we want to draw
attention to the term <span class="math inline">\(h.\)</span> We note
that the number of infective bites, per human, per day – called the
daily entomological inoculation rate (EIR) – is</p>
<p><span class="math display">\[E = f q e^{-g\tau} \frac YH
\]</span></p>
<p>We assume that exposure is Poisson distributed:</p>
<p><span class="math display">\[h = b E\]</span></p>
<p>We emphasize that this is the same set</p>
<hr>
<div class="float">
<img src="RossMacdonald3b.png" alt="Figure 1 - Diagram of a Ross-Macdonald model in Box 1, rewritten in a modular form."><div class="figcaption">
<strong>Figure 1</strong> - Diagram of a
Ross-Macdonald model in Box 1, rewritten in a modular form.</div>
</div>
<hr>
</div>
<div class="section level2">
<h2 id="computation">Computation<a class="anchor" aria-label="anchor" href="#computation"></a>
</h2>
<p>To solve these equations, we need to write functions that compute the
derivatives. We are using the R package <code>deSolve.</code> A properly
formed derivative function implementing the</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">RMv1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">y</span>, <span class="va">pars</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">pars</span>,<span class="op">{</span></span>
<span>      <span class="va">eir</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">g</span><span class="op">*</span><span class="va">n</span><span class="op">)</span><span class="op">*</span><span class="va">Y</span><span class="op">/</span><span class="va">H</span></span>
<span>      <span class="va">foi</span> <span class="op">=</span> <span class="va">b</span><span class="op">*</span><span class="va">eir</span></span>
<span>      <span class="va">kappa</span> <span class="op">=</span> <span class="va">c</span><span class="op">*</span><span class="va">I</span><span class="op">/</span><span class="va">H</span></span>
<span>      <span class="va">dX</span> <span class="op">=</span> <span class="va">foi</span><span class="op">*</span><span class="op">(</span><span class="va">H</span><span class="op">-</span><span class="va">I</span><span class="op">)</span> <span class="op">-</span> <span class="va">r</span><span class="op">*</span><span class="va">I</span></span>
<span>      <span class="va">dY</span> <span class="op">=</span> <span class="va">a</span><span class="op">*</span><span class="va">kappa</span><span class="op">*</span><span class="op">(</span><span class="va">M</span><span class="op">-</span><span class="va">Y</span><span class="op">)</span> <span class="op">-</span> <span class="va">g</span><span class="op">*</span><span class="va">Y</span> </span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">dX</span>, <span class="va">dY</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="full-modularity">Full Modularity<a class="anchor" aria-label="anchor" href="#full-modularity"></a>
</h2>
<p>For a longer discussion of modularity, see the vignette <a href="modularity.html">modularity</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sean L. Wu, David L. Smith.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
